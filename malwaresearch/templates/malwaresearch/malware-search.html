{% extends 'index.html' %}
{% load static %}
{% block content %}

<div class="container justify-center mx-auto">

    <h1>Malware Baazar</h1>
    <br>
    <form method="POST" class='flex'>
        {% csrf_token %}
        <label for="query" class='flex-initial w-64 mt-2'>Enter SHA256:</label>
        <input class='rounded' type="text" name='search' class='flex'>
        <button type='submit' class='w-14 h-10 font-bold'>Search</button>
    </form>
    <br>

    {% if query_status == "ok" %}
    <div id="accordion-collapse bg-slate-500" data-accordion="collapse">
        <h2 id="accordion-collapse-heading-1">
        <button type="button" class="bg-slate-900 flex justify-between items-center p-5 w-full font-medium text-left text-white rounded-t-xl border border-b-0 border-gray-200  dark:focus:ring-gray-800 dark:border-gray-700 dark:text-white hover:bg-gray-100 dark:hover:bg-gray-800" data-accordion-target="#accordion-collapse-body-1" aria-expanded="true" aria-controls="accordion-collapse-body-1">
            <span class='flex justify-between items-center'>File Information <img class='flex object-contain h-20 w-20 p-1' src="{% static "/imgs/search1.png" %}" alt="urlhaus" /> </span>
            <svg data-accordion-icon class="w-6 h-6 rotate-180 shrink-0" fill="currentColor" viewBox="0 0 20 20" xmlns="http://www.w3.org/2000/svg"><path fill-rule="evenodd" d="M5.293 7.293a1 1 0 011.414 0L10 10.586l3.293-3.293a1 1 0 111.414 1.414l-4 4a1 1 0 01-1.414 0l-4-4a1 1 0 010-1.414z" clip-rule="evenodd"></path></svg>
        </button>
        </h2>
        <div id="accordion-collapse-body-1" class="hidden" aria-labelledby="accordion-collapse-heading-1">
        <div class="p-5 border border-b-0 bg-slate-900 border-gray-200 dark:border-gray-700 dark:bg-gray-900">
            <p class="mb-2 text-gray-500 dark:text-white"><span class='font-bold italic'>SHA256:</span> <span class='text-blue-500 font-bold uppercase'>{{sha256_hash}}</span></p>
            <p class="mb-2 text-gray-500 dark:text-white"><span class='font-bold italic'>File Name: </span> <span class='text-blue-500 font-bold uppercase'>{{file_name}}</span></p>
            <p class="mb-2 text-gray-500 dark:text-white"><span class='font-bold italic'>File Type: </span> <span class='text-blue-500 font-bold uppercase'>{{file_type}}</span></p>
            <p class="mb-2 text-gray-500 dark:text-white"><span class='font-bold italic'>Imphash: </span> <span class='text-blue-500 font-bold uppercase'>{{imphash}}</span></p>
            <p class="mb-2 text-gray-500 dark:text-white"><span class='font-bold italic'>Ssdeep: </span> <span class='text-blue-500 font-bold uppercase'>{{ssdeep}}</span></p>
            <p class="mb-2 text-gray-500 dark:text-white"><span class='font-bold italic'>Signature: </span> <span class='rounded-3xl px-4 py-2 bg-red-600 text-red-100 font-bold'>{{signature}}</span></p>
            <p class="mb-2 text-gray-500 dark:text-white"><span class='font-bold italic'>First Seen: </span> <span class='text-blue-500 font-bold uppercase'>{{first_seen}}</span></p>
            <p class="mb-2 text-gray-500 dark:text-white"><span class='font-bold italic'>Last Seen: </span> <span class='text-blue-500 font-bold uppercase'>{{last_seen}}</span></p>
            <p class="mb-2 text-gray-500 dark:text-white"><span class='font-bold italic'>Delivery Method: </span> <span class='text-blue-500 font-bold uppercase'>{{delivery_method}}</span></p>
            {% comment %} <p class="mb-2 text-gray-500 dark:text-white"><span class='font-bold italic'>Yara Rule: </span> <span class='text-blue-500 font-bold uppercase'>{{data_0_yara_rules_0_rule_name}}</span></p> {% endcomment %}
            <p class="mb-2 text-gray-500 dark:text-white"><span class='font-bold italic'>Tags: </span> 
            {% for tag in tags  %}
            <span class='rounded-3xl px-4 py-2 bg-amber-500 text-red-100 font-bold'>{{tag}}</span>
            {% endfor %}
            </p>
            <br>
            {%  if urlhaus_value %}
            <a href="{{ urlhaus_value }}" class=' h-20 w-30 flex justify-between items-center text-white font-bold italic rounded px-4 py-2 bg-slate-700'>
                <img class='flex object-fill h-20 w-35 p-2' src="{% static '/imgs/urlhaus-abuse.png' %}" alt="urlhaus" /> 
                <img class='flex object-contain h-20 w-20' src="{% static "/imgs/www-1.png" %}" alt="website" /> 
            </a>
            
            {% endif %}
        </div>
        </div>
        <h2 id="accordion-collapse-heading-2">
        <button type="button" class="bg-slate-900 flex justify-between items-center p-5 w-full font-medium text-left text-gray-500 border border-b-0 border-gray-200 focus:ring-4 focus:ring-gray-200 dark:focus:ring-gray-800 dark:border-gray-700 dark:text-gray-400 hover:bg-gray-100 dark:hover:bg-gray-800" data-accordion-target="#accordion-collapse-body-2" aria-expanded="false" aria-controls="accordion-collapse-body-2">
            <span class='flex justify-between items-center'>Intelligence CLAMAV <img width="55px" height="55px" class='flex object-contain h-20 w-20 p-1' src="{% static '/imgs/AV.png' %}" alt="urlhaus" /> </span>
            <svg data-accordion-icon class="w-6 h-6 shrink-0" fill="currentColor" viewBox="0 0 20 20" xmlns="http://www.w3.org/2000/svg"><path fill-rule="evenodd" d="M5.293 7.293a1 1 0 011.414 0L10 10.586l3.293-3.293a1 1 0 111.414 1.414l-4 4a1 1 0 01-1.414 0l-4-4a1 1 0 010-1.414z" clip-rule="evenodd"></path></svg>
        </button>
        </h2>
        <div id="accordion-collapse-body-2" class="hidden" aria-labelledby="accordion-collapse-heading-2">
        <div class="p-5 border border-b-0 bg-slate-900 border-gray-200 dark:border-gray-700 dark:bg-gray-900">
            <p class="mb-2 text-gray-500 dark:text-gray-400">Flowbite is first conceptualized and designed using the Figma software so everything you see in the library has a design equivalent in our Figma file.</p>
        </div>
        </div>
        <h2 id="accordion-collapse-heading-3">
        <button type="button" class="bg-slate-900 flex justify-between items-center p-5 w-full font-medium text-left text-gray-500 border border-gray-200 focus:ring-4 focus:ring-gray-200 dark:focus:ring-gray-800 dark:border-gray-700 dark:text-gray-400 hover:bg-gray-100 dark:hover:bg-gray-800" data-accordion-target="#accordion-collapse-body-3" aria-expanded="false" aria-controls="accordion-collapse-body-3">
            <span class='flex justify-between items-center'>Yara Rule <img width="60" height="60" class='flex object-contain h-20 w-20 p-1' src="{% static "/imgs/yararule.png" %}" alt="yara" /> </span>
            <svg data-accordion-icon class="w-6 h-6 shrink-0" fill="currentColor" viewBox="0 0 20 20" xmlns="http://www.w3.org/2000/svg"><path fill-rule="evenodd" d="M5.293 7.293a1 1 0 011.414 0L10 10.586l3.293-3.293a1 1 0 111.414 1.414l-4 4a1 1 0 01-1.414 0l-4-4a1 1 0 010-1.414z" clip-rule="evenodd"></path></svg>
        </button>
        </h2>
        <div id="accordion-collapse-body-3" class="hidden" aria-labelledby="accordion-collapse-heading-3">
        <div class=" bg-slate-900 p-5 border border-t-0 border-gray-200 dark:border-gray-700">
            <p class="mb-2 text-gray-500 dark:text-gray-400">The main difference is that the core components from Flowbite are open source under the MIT license, whereas Tailwind UI is a paid product. Another difference is that Flowbite relies on smaller and standalone components, whereas Tailwind UI offers sections of pages.</p>
            <ul class="pl-5 list-disc text-gray-500 dark:text-gray-400">
            <li><a href="https://flowbite.com/pro/" class="text-blue-600 dark:text-blue-500 hover:underline">Flowbite Pro</a></li>
            <li><a href="https://tailwindui.com/" rel="nofollow" class="text-blue-600 dark:text-blue-500 hover:underline">Tailwind UI</a></li>
            </ul>
        </div>
        </div>
    </div>
    {% endif %}

    <p>{{dic_flattened}}</p>
    {% if query_status != 'ok' %}
    <p>Hash not found</p>
    {% endif %}
    <p>{{new_sha256}}</p>
    <p>{{sha256_hash}}</p>
    <p>{{file_name}}</p>
    <p>{{imphash}}</p>
    <p>{{resp}}</p>
    <p>{{intelligence}}</p>
    <p>Delivery Method: {{delivery_method}}</p>
    <p>Vendors Intel: 
        {% for item in  vendor_intel %}
            <p>{{item}}</p>
        {% endfor %}
        
    </p>


    {% for i in intelligence  %}
    <p>{{i}}</p>
    {% endfor %}
    <p>SSDEEP: {{ssdeep}}</p>
    <p>Tags: 
        {% for tag in tags  %}
        <p>{{tag}}</p>
        {% endfor %}
    </p>
</div>
{% endblock content %}


